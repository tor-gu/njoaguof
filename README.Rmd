---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# njoaguof

<!-- badges: start -->
<!-- badges: end -->

This is cleaned-up version of the NJ OAG Use of Force database
    available from https://www.njoag.gov/force/.

## Dataset Overview

* ```incident``` This is the main data table. Each use of force incident is recorded here. A single incident may involve multiple subjects.
* ```subject``` The subjects of the use of force -- includes persons and animals.
* ```incident```-specific data tables. Each of these data tables are for multi-value fields associated to incidents. For example -- a single incident may have both ```"Rain"``` and ```"Fog"``` weather conditions, and this will result in two rows in ```incident_weather```.
  + ```incident_contact_origin```
  + ```incident_lighting```
  + ```incident_location_type```
  + ```incident_officer_injury_type```
  + ```incident_officer_medical_treatment```
  + ```incident_planned_contact```
  + ```incident_type```
  + ```incident_video_type```
  + ```incident_weather```
* ```incident```-```subject``` data tables These data tables are for multi-value fields that should be associated to individual incident subjects. Unfortunately, these tables reflect some irreducible messiness of the source data. See the notes below.
  + ```incident_force_type```
  + ```incident_perceived_condition```
  + ```incident_subject_action```
  + ```incident_subject_injury```
  + ```incident_subject_medical_treatment```
  + ```incident_subject_resistance```
* ```officer_name_variants``` Includes every variation in spelling and capitalization of the officer names found in the source data.
* ```use_of_force_raw``` The source data.

## Examples
Every incident has a unique ```form_id```, and this field is used to link the ```subject``` and ```incident_xxx``` tables to specific incidents:
```{r}
library(njoaguof)
library(dplyr)
# Summarize video_type by agency_county
incident %>%
  select(form_id, agency_county) %>%
  right_join(incident_video_type, by = "form_id") %>%
  count(agency_county, video_type)
```

```{r}
library(njoaguof)
library(dplyr)
# Summarize subject gender by officer gender
incident %>% 
  select(form_id, officer_gender) %>% 
  right_join(subject, by="form_id") %>%
  count(officer_gender, subject_gender=gender)
```

## Notes

The raw data from the NJ OAG is available in table ```use_of_force_raw```, which has one row for each use of force incident.  Fields with multiple values are recorded as comma separated lists. For example:
```{r}
use_of_force_raw %>% count(SubectsGender) %>% head(5)
```
These fields are broken out into new data tables in the following categories.

#### Subject Fields
Several fields contain one value for each subject. We presume that the order is preserved, so that we may create one row for each subject in the ```subject``` table.
```{r}
use_of_force_raw %>% filter(form_id == 16301) %>%
  select(
    form_id,
    SubjectsArrested,
    subject_type,
    SubectsAge,
    SubjectRace,
    SubectsGender,
    SubectsGender
  )

subject %>% filter(form_id == 16301)
```

#### Multi-value incident ields
Some fields contain multiple values for 
#### Multi-value Incident-Subject Fields


The cleaned data is available in the following tables:

* ```incident``` There is one row in this table for each incident.
* ```subject```  There is one row in this table for each subject.

## Installation

You can install the development version of njoaguof from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("tor-gu/njoaguof")
```
